{"ast":null,"code":"const {\n  Router\n} = require('express');\n\nconst config = require('config');\n\nconst Fanfic = require('../models/Fanfic');\n\nconst auth = require('../middleware/auth.middleware');\n\nconst router = Router();\nrouter.post('/generate', async (req, res) => {\n  try {\n    const baseUrl = config.get('baseUrl');\n    const {\n      title,\n      genre,\n      shortDescription,\n      userId\n    } = req.body;\n    const fanfic = new Fanfic({\n      title,\n      genre,\n      shortDescription,\n      author: userId,\n      likes: 0\n    });\n    await fanfic.save();\n    res.status(201).json({\n      message: 'Fanfic created'\n    });\n  } catch (error) {\n    console.dir(error);\n    res.status(500).json({\n      message: 'Something went wrong, please try again'\n    });\n  }\n});\nrouter.get('/', auth, async (req, res) => {\n  try {\n    console.dir(req.user.userId);\n    const fanfics = await Fanfic.find({\n      author: req.user.userId\n    });\n    res.json(fanfics);\n  } catch (error) {\n    res.status(500).json({\n      message: 'Something went wrong, please try again'\n    });\n  }\n});\nrouter.get('/:id', async (req, res) => {\n  try {\n    const fanfic = Fanfic.findById(req.params.id);\n    res.json(fanfic);\n  } catch (error) {\n    res.status(500).json({\n      message: 'Something went wrong, please try again'\n    });\n  }\n});\nmodule.exports = router;","map":{"version":3,"sources":["D:/course/routes/fanfic.routes.js"],"names":["Router","require","config","Fanfic","auth","router","post","req","res","baseUrl","get","title","genre","shortDescription","userId","body","fanfic","author","likes","save","status","json","message","error","console","dir","user","fanfics","find","findById","params","id","module","exports"],"mappings":"AAAA,MAAM;AAACA,EAAAA;AAAD,IAAWC,OAAO,CAAC,SAAD,CAAxB;;AACA,MAAMC,MAAM,GAAGD,OAAO,CAAE,QAAF,CAAtB;;AACA,MAAME,MAAM,GAAGF,OAAO,CAAC,kBAAD,CAAtB;;AACA,MAAMG,IAAI,GAAGH,OAAO,CAAC,+BAAD,CAApB;;AACA,MAAMI,MAAM,GAAGL,MAAM,EAArB;AAEAK,MAAM,CAACC,IAAP,CAAY,WAAZ,EAAyB,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AACzC,MAAI;AACA,UAAMC,OAAO,GAAGP,MAAM,CAACQ,GAAP,CAAY,SAAZ,CAAhB;AACA,UAAM;AAACC,MAAAA,KAAD;AAAQC,MAAAA,KAAR;AAAeC,MAAAA,gBAAf;AAAiCC,MAAAA;AAAjC,QAA2CP,GAAG,CAACQ,IAArD;AAGA,UAAMC,MAAM,GAAG,IAAIb,MAAJ,CAAY;AAAEQ,MAAAA,KAAF;AAASC,MAAAA,KAAT;AAAgBC,MAAAA,gBAAhB;AAAkCI,MAAAA,MAAM,EAAEH,MAA1C;AAAkDI,MAAAA,KAAK,EAAE;AAAzD,KAAZ,CAAf;AACA,UAAMF,MAAM,CAACG,IAAP,EAAN;AAEAX,IAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AAAEC,MAAAA,OAAO,EAAE;AAAX,KAArB;AAGH,GAXD,CAWE,OAAOC,KAAP,EAAc;AACZC,IAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACAf,IAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAsB;AAACC,MAAAA,OAAO,EAAE;AAAV,KAAtB;AACH;AAEJ,CAjBD;AAmBAjB,MAAM,CAACK,GAAP,CAAW,GAAX,EAAgBN,IAAhB,EAAuB,OAAOG,GAAP,EAAYC,GAAZ,KAAoB;AACvC,MAAI;AACAgB,IAAAA,OAAO,CAACC,GAAR,CAAYlB,GAAG,CAACmB,IAAJ,CAASZ,MAArB;AACA,UAAMa,OAAO,GAAG,MAAMxB,MAAM,CAACyB,IAAP,CAAY;AAAEX,MAAAA,MAAM,EAAEV,GAAG,CAACmB,IAAJ,CAASZ;AAAnB,KAAZ,CAAtB;AACAN,IAAAA,GAAG,CAACa,IAAJ,CAASM,OAAT;AACH,GAJD,CAIE,OAAOJ,KAAP,EAAc;AACZf,IAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAsB;AAACC,MAAAA,OAAO,EAAE;AAAV,KAAtB;AACH;AAEJ,CATD;AAWAjB,MAAM,CAACK,GAAP,CAAW,MAAX,EAAmB,OAAOH,GAAP,EAAYC,GAAZ,KAAoB;AACnC,MAAI;AACA,UAAMQ,MAAM,GAAGb,MAAM,CAAC0B,QAAP,CAAgBtB,GAAG,CAACuB,MAAJ,CAAWC,EAA3B,CAAf;AACAvB,IAAAA,GAAG,CAACa,IAAJ,CAASL,MAAT;AAEH,GAJD,CAIE,OAAOO,KAAP,EAAc;AACZf,IAAAA,GAAG,CAACY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAsB;AAACC,MAAAA,OAAO,EAAE;AAAV,KAAtB;AACH;AAEJ,CATD;AAWAU,MAAM,CAACC,OAAP,GAAiB5B,MAAjB","sourcesContent":["const {Router} = require('express')\r\nconst config = require ('config')\r\nconst Fanfic = require('../models/Fanfic')\r\nconst auth = require('../middleware/auth.middleware')\r\nconst router = Router()\r\n\r\nrouter.post('/generate', async (req, res) => {\r\n    try {\r\n        const baseUrl = config.get ('baseUrl')\r\n        const {title, genre, shortDescription, userId} = req.body\r\n\r\n\r\n        const fanfic = new Fanfic ({ title, genre, shortDescription, author: userId, likes: 0})\r\n        await fanfic.save()\r\n\r\n        res.status(201).json({ message: 'Fanfic created'})\r\n\r\n              \r\n    } catch (error) {\r\n        console.dir(error)\r\n        res.status(500).json ({message: 'Something went wrong, please try again'})\r\n    }\r\n\r\n})\r\n\r\nrouter.get('/', auth , async (req, res) => {\r\n    try {\r\n        console.dir(req.user.userId)\r\n        const fanfics = await Fanfic.find({ author: req.user.userId})\r\n        res.json(fanfics)              \r\n    } catch (error) {\r\n        res.status(500).json ({message: 'Something went wrong, please try again'})\r\n    }\r\n\r\n})\r\n\r\nrouter.get('/:id', async (req, res) => {\r\n    try {\r\n        const fanfic = Fanfic.findById(req.params.id)\r\n        res.json(fanfic) \r\n              \r\n    } catch (error) {\r\n        res.status(500).json ({message: 'Something went wrong, please try again'})\r\n    }\r\n\r\n})\r\n\r\nmodule.exports = router"]},"metadata":{},"sourceType":"script"}